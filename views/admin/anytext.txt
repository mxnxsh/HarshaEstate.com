<%if(message){%>
<div class="container">
    <div class="alert alert-success" role="alert">
        <%=message%>

        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
    </div>
    <%}%>

    mongodb+srv://meetRealEstate:12345@cluster0-rxp9x.mongodb.net/meetCollection?retryWrites=true&w=majority

    <% categories.forEach(function(c){ %>
    <a href="/category/<%=c.slug%>" class="btn btn-primary buttonStyle"><%=c.title%></a>
    <%})%>

                                    <% if (amenities.find(amenitie=> amenitie=="Garden" )) { %> checked="checked" <% } %>
                                <% if (amenities.find(amenitie=> amenitie=="Power Backup" )) { %> checked="checked" <% } %>
                                <% if (amenities.find(amenitie=> amenitie=="List" )) { %> checked="checked" <% } %>
                                <% if (amenities.find(amenitie=> amenitie=="Children Play Area" )) { %> checked="checked" <% } %>
                                <% if (option1 == "Non Rental") { %> checked="checked" <% } %>
                                <% if (option1 == "Rental") { %> checked="checked" <% } %>
<%=NonRental%>
<%=Rental%>


//   console.log(req.body.pimage);
  //    console.log(typeof req.body);
  
var imageFile = typeof req.file !== "undefined" ? req.file : "";
  console.log("Current =" + imageFile);
  var title = req.body.title;
  var slug = title.replace(/\s+/g, "-").toLowerCase();
  var desc = req.body.desc;
  var price = req.body.price;
  var deposit = req.body.deposit;
  var category = req.body.category;
  var option1 = req.body.option1;
  var option2 = req.body.option2;
  var amenities = req.body.amenities;
  var nearby = req.body.nearby;
  var pimage = req.body.pimage;
  console.log("Previous image  = " + pimage);
  var id = req.params.id;
  Product.findOne({
    slug: slug,
    _id: {
      $ne: id
    }
  }, function (err, p) {
    console.log("Details=" + p);
    if (err) console.log(err);
    // if (p) {
    //     res.redirect("/admin/edit_products/" + id);
    // }
    else {
      Product.findById(id, function (err, p) {
        if (err) return console.log(err);
        p.title = title;
        p.slug = slug;
        p.desc = desc;
        p.option1 = option1;
        p.price = parseFloat(price).toFixed(2);
        p.deposit = deposit;
        p.option2 = option2;
        p.category = category;
        p.amenities = amenities;
        p.nearby = nearby;
        if (imageFile != "") {
          p.image = imageFile;
        } else {
          p.image = pimage;
        }
        p.save(function (err) {
          if (err) console.log(err);
          if (imageFile != "") {
            if (pimage != "") {
              fs.unlink("public/uploads/" + pimage, function (err) {
                if (err) console.log(err);
              });
            }
          }
          res.redirect("products");
        });
      });
    }
  });


  <% products.forEach(function(p){ %>
            <div class="col-lg-3 col-md-6 properties_card text-center text-capitalize">
                <div class="card mx-auto property-info text-center" style="width: 18rem;">
                    <a href=""><img src="/uploads/<%=p.image%>" class="card-img-top img-fluid imageStyle"
                            alt="Properties image"> </a>
                    <div class="card-body">
                        <h5 class="card-title"><%=p.title%></h5>
                        <p class="card-text">Price:&#8377;<%=p.price%></p>
                        <p class="card-text"><%=p.option1%></p>
                        <p class="card-text"><%=p.category%></p>
                        <a href="#" class="btn whatsbtn btn-success">
                            <span><i class="fa fa-whatsapp" style="font-size: 1.2rem;"></i></span>
                        </a>
                    </div>
                </div>
                <br /><br />
            </div>
            <% }); %>

                // "alert": "^5.0.0",
<!-- Multiple images upload -->
      <div class="col">
         <form action="/admin/uploadImage" method="POST" enctype="multipart/form-data">
            <div class="form-group">
               <label>Image</label>
               <input type="file" class="form-control-file" name="image" id="img" multiple />
               <img src="#" id="imgPreview" alt="" />
               <hr />
               <div class="row">
                  <div class="col-sm-12">
                     <div class="preview-images"></div>
                  </div>
               </div>
            </div>
            <button type="submit" class="btn btn-primary">Upload</button>
         </form>
      </div>


      <!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <!-- External CSS -->
    <link rel="stylesheet" href="/css/stylesProduct.css">
    <!--<link rel="stylesheet" href="styles.css">-->
    <!-- Font Awesome -->
    <script src="https://use.fontawesome.com/34b345c35f.js"></script>
    <title>Harsha Estate &mdash; No.1 Property Consultant</title>
    <!-- owl carousel -->
    <link rel="stylesheet" href="/css/owl.carousel.css">

</head>
                 
<% if (errors) {%>
          <br />
          <%errors.forEach(function(error) { %>
          <div class="alert alert-danger">
            <%= error.msg %>
          </div>
          <% });%>
          <% }%>
          
          <% if(typeof errors.errors != 'undefined'){ %> <%errors.forEach(function(error)
{ %>
<div class="alert alert-warning alert-dismissible fade show" role="alert">
   <%= error.msg %>
   <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
   </button>
</div>
<% }); %> <% } %>


<div class="container">
        <% if(errors) {%> <% errors.forEach(function(error) { %>
        <div class="alert alert-danger">
            <%= error.msg %>
        </div>
        <% });%> <% }%>
    </div>